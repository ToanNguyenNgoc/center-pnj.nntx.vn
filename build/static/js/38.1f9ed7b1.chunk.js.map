{"version":3,"file":"static/js/38.1f9ed7b1.chunk.js","mappings":"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","sources":["app/pages/users/UsersPage.tsx"],"sourcesContent":["import { observer } from \"mobx-react-lite\";\nimport { FC, useState } from \"react\";\nimport { Avatar, ButtonLoading, ConfirmAction, Input, Pagination, PermissionLayout, Switch, TabletBufferZone, TitlePage } from \"../../components\";\nimport { KTSVG } from \"../../../_metronic/helpers\";\nimport { useStores } from \"../../models/store\";\nimport { useMutation, useQuery } from \"react-query\";\nimport { Const } from \"../../common\";\nimport { formatDate, Toast } from \"../../utils\";\nimport { useDebounce, useQueryParams } from \"../../hooks\";\nimport { IUserProfile, QrUser, ReqPostUser } from \"../../interfaces\";\nimport { Link, useNavigate } from \"react-router-dom\";\n\nconst UsersPage: FC = observer(() => {\n  const navigate = useNavigate();\n  const { query, handleQueryString } = useQueryParams<QrUser>();\n  const search = useDebounce(query.search || '');;\n  const { userModel } = useStores();\n  const { data, isLoading, refetch } = useQuery({\n    queryKey: [Const.QueryKey.users, { ...query, search }],\n    queryFn: () => userModel.getUsers({ ...query, search, sort: '-createdAt' }),\n  })\n  const mutateDelete = useMutation({\n    mutationFn: (id: number) => userModel.deleteUser(id),\n    onSuccess() { Toast.success('Xóa thành công'); refetch(); ConfirmAction.close() },\n    onError() { Toast.error() }\n  })\n  const onDelete = (id: number) => {\n    ConfirmAction.open({\n      callBack: () => mutateDelete.mutate(id)\n    })\n  }\n  return (\n    <PermissionLayout permissions={['.users.get']} showEmpty>\n      <TitlePage title=\"Người dùng\"\n        element={\n          <PermissionLayout permissions={['.users.post']}>\n            <ButtonLoading title=\"Tạo mới\" onClick={() => navigate('/apps/users-form')} />\n          </PermissionLayout>\n        }\n      />\n      <div className={`card`}>\n        {/* begin::Header */}\n        <div className='card-header border-0 pt-5'>\n          <div className=\"w-25\">\n            <Input\n              placeholder=\"Tìm kiếm Tên, email, điện thoại...\"\n              defaultValue={query.search}\n              onChange={e => handleQueryString('search', e.target.value)}\n            />\n          </div>\n        </div>\n        {/* end::Header */}\n        {/* begin::Body */}\n        <div className='card-body py-3'>\n          {/* begin::Table container */}\n          <div className='table-responsive'>\n            {/* begin::Table */}\n            <table className='table align-middle gs-0 gy-4'>\n              {/* begin::Table head */}\n              <thead>\n                <tr className='fw-bold text-muted bg-light'>\n                  <th className='ps-4 min-w-250px rounded-start'>Thông tin</th>\n                  <th className='ps-4 min-w-250px rounded-start'>Email</th>\n                  <th className='min-w-125px'>Quyền</th>\n                  <th className='min-w-125px'>Ngày tạo</th>\n                  <th className='min-w-125px'>Cập nhật</th>\n                  <th className='min-w-100px'>Trạng thái</th>\n                  <th className='min-w-100px text-end rounded-end'></th>\n                </tr>\n              </thead>\n              {/* end::Table head */}\n              {/* begin::Table body */}\n              <tbody>\n                <TabletBufferZone\n                  isLoading={isLoading}\n                  isEmpty={data?.total === 0 && !isLoading}\n                />\n                {\n                  data?.data?.map(user => (\n                    <UserItem key={user.id} user={user} onDelete={onDelete} />\n                  ))\n                }\n              </tbody>\n              {/* end::Table body */}\n            </table>\n            {/* end::Table */}\n            <Pagination\n              count={data?.total_page}\n              page={query.page}\n              onChangePage={e => handleQueryString('page', e)}\n            />\n          </div>\n          {/* end::Table container */}\n        </div>\n        {/* begin::Body */}\n      </div>\n    </PermissionLayout>\n  )\n})\n\ninterface UserItemProps {\n  user: IUserProfile;\n  onDelete?: (id: number) => void;\n}\n\nconst UserItem: FC<UserItemProps> = ({ user, onDelete = () => null }) => {\n  const { userModel } = useStores()\n  const [active, setActive] = useState(user.active);\n  const { mutate } = useMutation({\n    mutationFn: (body: ReqPostUser) => userModel.patchUser(user.id, body),\n    onSuccess() {\n      Toast.success();\n    },\n    onError() {\n      setActive(user.active);\n      Toast.error();\n    },\n  })\n  const onChangeStatus = (check: boolean) => {\n    setActive(check);\n    mutate({ active: check })\n  }\n  return (\n    <tr key={user.id}>\n      <td>\n        <div className='d-flex align-items-center'>\n          <div className='symbol symbol-50px me-5'>\n            <Avatar imageUrl={user.media?.original_url} size={50} />\n          </div>\n          <div className='d-flex justify-content-start flex-column'>\n            <span className='text-dark fw-bold text-hover-primary mb-1 fs-6'>\n              {user.fullname}\n            </span>\n            <span className='text-muted fw-semobold text-muted d-block fs-7'>\n              {user.telephone}\n            </span>\n          </div>\n        </div>\n      </td>\n      <td>\n        <span className='text-dark d-block mb-1 fs-6'>\n          {user.email}\n        </span>\n      </td>\n      <td>\n        <span className='text-dark fw-bold d-block mb-1 fs-6'>\n          {user.roles.length === 0 ? 'Khách' : 'Đội ngũ'}\n        </span>\n      </td>\n      <td>\n        <span className='text-dark fw-bold d-block mb-1 fs-6'>\n          {formatDate(user.createdAt)}\n        </span>\n      </td>\n      <td>\n        <span className='text-dark fw-bold d-block mb-1 fs-6'>\n          {formatDate(user.updatedAt)}\n        </span>\n      </td>\n      <td>\n        <PermissionLayout permissions={['.users.:id.patch']}>\n          <Switch\n            checked={active}\n            onChange={onChangeStatus}\n          />\n        </PermissionLayout>\n      </td>\n      <td className='text-end'>\n        <PermissionLayout permissions={['.users.:id.get', '.users.:id.patch']}>\n          <Link\n            to={`/apps/users-form/${user.id}`}\n            className='btn btn-icon btn-bg-light btn-active-color-primary btn-sm me-1'\n          >\n            <KTSVG path='/media/icons/duotune/art/art005.svg' className='svg-icon-3' />\n          </Link>\n        </PermissionLayout>\n        <PermissionLayout permissions={['.users.:id.delete']}>\n          <button\n            onClick={() => onDelete(user.id)}\n            className='btn btn-icon btn-bg-light btn-active-color-primary btn-sm'\n          >\n            <KTSVG path='/media/icons/duotune/general/gen027.svg' className='svg-icon-3' />\n          </button>\n        </PermissionLayout>\n      </td>\n    </tr>\n  )\n}\n\nexport default UsersPage;"],"names":["UsersPage","observer","navigate","useNavigate","useQueryParams","query","handleQueryString","search","useDebounce","userModel","useStores","useQuery","queryKey","Const","queryFn","getUsers","sort","data","isLoading","refetch","mutateDelete","useMutation","mutationFn","id","deleteUser","onSuccess","Toast","ConfirmAction","onError","onDelete","callBack","mutate","permissions","showEmpty","title","element","onClick","className","placeholder","defaultValue","onChange","e","target","value","isEmpty","total","map","user","UserItem","count","total_page","page","onChangePage","useState","active","setActive","body","patchUser","imageUrl","media","original_url","size","fullname","telephone","email","roles","length","formatDate","createdAt","updatedAt","checked","check","to","path"],"sourceRoot":""}